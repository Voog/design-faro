!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";var t,o;o=function(){function t(t){this.comparator=t,this.contents=[],this.sorted=!1}return t.prototype.sort=function(){return this.contents.sort(this.comparator),this.sotred=!0},t.prototype.push=function(t){return this.contents.push(t),this.sorted=!1},t.prototype.peek=function(t){return null==t&&(t=this.contents.length-1),this.sorted||this.sort(),this.contents[t]},t.prototype.pop=function(){return this.sorted||this.sort(),this.contents.pop()},t.prototype.size=function(){return this.contents.length},t.prototype.map=function(t){return this.contents.map(t)},t}(),t=function(){var t,e,n,r,i,s;function c(){this.maxIterations=1e3,this.fractByPopulations=.75}return c.sigbits=5,c.rshift=8-c.sigbits,r=function(t,o,e){return(t<<2*c.sigbits)+(o<<c.sigbits)+e},t=function(){function t(t,o,e,n,r,i,s){this.r1=t,this.r2=o,this.g1=e,this.g2=n,this.b1=r,this.b2=i,this.histo=s}return t.prototype.volume=function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},t.prototype.count=function(t){var o,e,n,i,s,c,u,a,h,p,f;if(!this._count_set||t){for(i=0,s=c=this.r1,h=this.r2;c<=h;s=c+=1)for(e=u=this.g1,p=this.g2;u<=p;e=u+=1)for(o=a=this.b1,f=this.b2;a<=f;o=a+=1)n=r(s,e,o),i+=this.histo[n]||0;this._count_set=!0,this._count=i}return this._count},t.prototype.copy=function(){return new t(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},t.prototype.average=function(t){var o,e,n,i,s,u,a,h,p,f,l,g,d,b,m,v;if(!this._average||t){for(a=1<<8-c.sigbits,f=0,p=0,i=0,e=0,h=l=this.r1,b=this.r2;l<=b;h=l+=1)for(n=g=this.g1,m=this.g2;g<=m;n=g+=1)for(o=d=this.b1,v=this.b2;d<=v;o=d+=1)u=r(h,n,o),f+=s=this.histo[u]||0,p+=s*(h+.5)*a,i+=s*(n+.5)*a,e+=s*(o+.5)*a;this._average=f?[~~(p/f),~~(i/f),~~(e/f)]:[~~(a*(this.r1+this.r2+1)/2),~~(a*(this.g1+this.g2+1)/2),~~(a*(this.b1+this.b2+1)/2)]}return this._average},t.prototype.contains=function(t){var o,e,n;return n=t[0]>>c.rshift,e=t[1]>>c.rshift,o=t[2]>>c.rshift,this.r1<=n&&n<=this.r2&&this.g1<=e&&e<=this.g2&&this.b1<=o&&o<=this.b2},t}(),e=function(){function t(){this.cboxes=new o((function(t,o){var e,n;return(e=t.count()*t.volume())>(n=o.count()*o.volume())?1:e<n?-1:0}))}return t.prototype.push=function(t){return this.cboxes.push({cbox:t,color:t.average()})},t.prototype.palette=function(){return this.cboxes.map((function(t){return t.color}))},t.prototype.size=function(){return this.cboxes.size()},t.prototype.map=function(t){var o,e,n;for(o=e=0,n=this.cboxes.size();e<n;o=e+=1)return this.cboxes.peek(o).cbox.contains(t)?this.cboxes.peek(o).color:this.nearest(t)},t.prototype.cboxes=function(){return this.cboxes},t.prototype.nearest=function(t){var o,e,n,r,i,s,c;for(i=function(t){return t*t},n=1e9,e=s=0,c=this.cboxes.size();s<c;e=s+=1)(o=Math.sqrt(i(t[0]-this.cboxes.peek(e).color[0])+i(t[1]-this.cboxes.peek(e).color[1])+i(t[2]-this.cboxes.peek(e).color[2])))<n&&(n=o,r=this.cboxes.peek(e).color);return r},t}(),i=function(t){var o,e,n,i,s,u,a,h,p;for(i=1<<3*c.sigbits,n=new Array(i),h=0,p=t.length;h<p;h++)a=(u=t[h])[0]>>c.rshift,e=u[1]>>c.rshift,o=u[2]>>c.rshift,n[s=r(a,e,o)]=(n[s]||0)+1;return n},n=function(o,e){var n,r,i,s,u,a,h,p,f,l,g,d;for(l=1e6,f=0,a=1e6,u=0,i=1e6,r=0,g=0,d=o.length;g<d;g++)(p=(h=o[g])[0]>>c.rshift)<l?l=p:p>f&&(f=p),(s=h[1]>>c.rshift)<a?a=s:s>u&&(u=s),(n=h[2]>>c.rshift)<i?i=n:n>r&&(r=n);return new t(l,f,a,u,i,r,e)},s=function(t,o){var e,n,i,s,c,u,a,h,p,f,l,g,d,b,m,v,y,x,w,C,_,j,k,z,M,O,I,P,q,S;if(o.count()){if(1===o.count())return[o.copy()];if(f=o.r2-o.r1+1,c=o.g2-o.g1+1,n=o.b2-o.b1+1,a=Math.max(f,c,n),g=0,h=[],u=[],a===f)for(p=d=o.r1,j=o.r2;d<=j;p=d+=1){for(l=0,s=b=o.g1,I=o.g2;b<=I;s=b+=1)for(e=m=o.b1,P=o.b2;m<=P;e=m+=1)l+=t[r(p,s,e)]||0;g+=l,h[p]=g}else if(a===c)for(s=v=o.g1,q=o.g2;v<=q;s=v+=1){for(l=0,p=y=o.r1,S=o.r2;y<=S;p=y+=1)for(e=x=o.b1,k=o.b2;x<=k;e=x+=1)l+=t[r(p,s,e)]||0;g+=l,h[s]=g}else for(e=w=o.b1,z=o.b2;w<=z;e=w+=1){for(l=0,p=C=o.r1,M=o.r2;C<=M;p=C+=1)for(s=_=o.g1,O=o.g2;_<=O;s=_+=1)l+=t[r(p,s,e)]||0;g+=l,h[e]=g}return h.forEach((function(t,o){return u[o]=g-t})),i=function(t){var e,n,r,i,s,c,a,p,f,l,d;for(c=t+"2",a=l=o[s=t+"1"],d=o[c];l<=d;a=l+=1)if(h[a]>g/2){for(e=o.copy(),n=o.copy(),i=(p=a-o[s])<=(f=o[c]-a)?Math.min(o[c]-1,~~(a+f/2)):Math.max(o[s],~~(a-1-p/2));!h[i];)i++;for(r=u[i];!r&&h[i-1];)r=u[--i];return e[c]=i,n[s]=e[c]+1,[e,n]}},a===f?i("r"):a===c?i("g"):a===n?i("b"):void 0}},c.prototype.quantize=function(t,r){var c,u,a,h,p,f,l=this;if(!t.length||r<2||r>256)return console.log("invalid arguments"),!1;for(a=i(t),c=n(t,a),(p=new o((function(t,o){var e,n;return(e=t.count())>(n=o.count())?1:e<n?-1:0}))).push(c),(h=function(t,o){var e,n,r,i,u;for(i=1,u=0;u<l.maxIterations;)if((c=t.pop()).count()){if(e=(r=s(a,c))[0],n=r[1],!e)return void console.log("cbox1 not defined; shouldn't happen");if(t.push(e),n&&(t.push(n),i++),i>=o)return;if(u++>l.maxIterations)return void console.log("infinite loop; perhaps too few pixels")}else t.push(c),u++})(p,this.fractByPopulations*r),f=new o((function(t,o){var e,n;return(e=t.count()*t.volume())>(n=o.count()*o.volume())?1:e<n?-1:0}));p.size();)f.push(p.pop());for(h(f,r-f.size()),u=new e;f.size();)u.push(f.pop());return u},c}.call(void 0),function(){window.ColorExtract=function(){function o(){}return o.getColorMap=function(o,e,n,r,i,s){var c,u,a,h,p,f,l,g,d,b;for(null==s&&(s=8),a=o.getContext("2d").getImageData(e,n,r,i).data,h=[],f=l=n,d=n+i;l<d;f=l+=1)for(u=f*r*4,p=g=e,b=e+r;g<b;p=g+=1)c=u+4*p,h.push([a[c],a[c+1],a[c+2]]);return(new t).quantize(h,s)},o.colorDist=function(t,o){var e;return(e=function(t){return t*t})(t[0]-o[0])+e(t[1]-o[1])+e(t[2]-o[2])},o.extract=function(t,e,n){var r,i,s,c,u,a,h,p,f,l,g,d,b;for(e.width=25,e.height=25,e.getContext("2d").drawImage(t,0,0,e.width,e.height),(i=o.getColorMap(e,0,0,e.width,e.height,4).cboxes.map((function(t){return{count:t.cbox.count(),rgb:t.color}}))).sort((function(t,o){return o.count-t.count})),r=i[0].rgb,(h=o.getColorMap(e,0,0,t.width,t.height,10).cboxes.map((function(t){return{count:t.cbox.count(),rgb:t.color}}))).sort((function(t,o){return o.count-t.count})),p=0,l=0,d=h.length;l<d;l++)s=h[l],(c=o.colorDist(r,s.rgb))>p&&(p=c,u=s.rgb);for(p=0,g=0,b=h.length;g<b;g++)s=h[g],(c=o.colorDist(r,s.rgb))>p&&s.rgb!==u&&(p=c,a=s.rgb);return f=function(t){return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},n({bgColor:f(r),fgColor:f(u),fgColor2:f(a)})},o}()}.call(void 0),function(t){const o=(t,o,e)=>{let n;return function(){const r=this,i=arguments;let s=e&&!n;clearTimeout(n),n=setTimeout((function(){n=null,e||t.apply(r,i)}),o),s&&t.apply(r,i)}},e=()=>{const o=t(".js-menu-main"),e=o.find(".dropdown-menu, .dropdown-menu-visible"),n=e.find(".dropdown-menu-children"),r=o.find(".menu").append(n.children()),i=r.find(".menu-item-wrapper"),s=[];i.each(((o,e)=>{(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&(0===s.length&&s.push(i[o-1]),s.push(t(e)))})),s.length>0&&(n.append(s),e.append(n),r.append(e),e.removeClass("dropdown-menu").addClass("dropdown-menu-visible"))},n=()=>{const t=Voog.ShoppingCart;return t?t.getContents().items.reduce(((t,o)=>t+o.quantity),0):0},r=(o,e)=>{const r=n(),i=t(".cart-btn"),s=t(".cart-btn .cart-btn-count"),c=parseInt(s.text())||0,u=t(".edy-ecommerce-modal-open").length>=1;let a;if(r>=1||e){if(null!=a&&clearTimeout(a),r>c&&!u){const e=t("html").attr("lang");let n=o.detail.product_name;Object.prototype.hasOwnProperty.call(o.detail,"translations")&&Object.prototype.hasOwnProperty.call(o.detail.translations,"name")&&Object.prototype.hasOwnProperty.call(o.detail.translations.name,e)&&(n=o.detail.translations.name[e]),t(".cart-popover .product-name").text(n),t(":not(body.edy-ecommerce-modal-open) .cart-popover").addClass("visible"),a=setTimeout((function(){t(".cart-popover").removeClass("visible")}),3e3)}i.addClass("active"),s.text(r)}else i.removeClass("active"),s.text("")},i=()=>{t(document).on("voog:shoppingcart:removeproduct",(t=>{r(t,!1)})),t(document).on("voog:shoppingcart:changequantity",(t=>{r(t,!0)})),t(document).on("voog:shoppingcart:addproduct",(t=>{r(t,!0)})),t(document).on("voog:shoppingcart:contentschanged",(()=>{(()=>{const o=n(),e=t(".cart-btn"),r=t(".cart-btn .cart-btn-count");o>=1?(e.addClass("active"),r.text(o)):(e.removeClass("active"),r.text(""))})()})),t(".cart-btn, .cart-popover").click((()=>{n()>=1&&Voog.ShoppingCart.showCart()}))};window.site=t.extend(window.site||{},{bindSiteSearch:function(o,e,n){o&&new VoogSearch(o,{per_page:10,lang:e,resultsContainer:t(".js-voog-search-modal-inner").get(0),sideclick:!0,mobileModeWidth:480,updateOnKeypress:!0,noResults:n})},handleCategoriesPageContent:()=>{const o=t(".js-header").height();t(".js-category-section").css("height","calc(calc(100vh - 96px) - "+o+"px)")}}),t(".container").on("mousedown",(function(o){t(o.target).closest(".js-prevent-sideclick").length||(t(".js-popover").removeClass("expanded"),t(".js-search-close-btn").trigger("click"),t(".js-image-settings-popover").toggleClass("active"))})),t(document).ready((()=>{e()})),t(window).resize(o((()=>{e()}),250)),i(),t(document).on("voog:shoppingcart:button:created",(()=>{n()>=1&&(t(".cart-btn").addClass("active"),t(".cart-btn .cart-btn-count").text(n()))}))}(jQuery)}));
